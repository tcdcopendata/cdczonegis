L.LineUtil.PolylineDecorator={computeAngle:function(n,t){return Math.atan2(t.y-n.y,t.x-n.x)*180/Math.PI+90},getPointPathPixelLength:function(n){var u=n.length,i,r,f,t;if(u<2)return 0;for(i=0,r=n[0],t=1;t<u;t++)i+=r.distanceTo(f=n[t]),r=f;return i},getPixelLength:function(n,t){var r=n instanceof L.Polyline?n.getLatLngs():n,e=r.length,u,f,o,i;if(e<2)return 0;for(u=0,f=t.project(r[0]),i=1;i<e;i++)u+=f.distanceTo(o=t.project(r[i])),f=o;return u},projectPatternOnPath:function(n,t,i,r){var e=[],u,f;for(u=0,l=n.length;u<l;u++)e[u]=r.project(n[u]);for(f=this.projectPatternOnPointPath(e,t,i),u=0,l=f.length;u<l;u++)f[u].latLng=r.unproject(f[u].pt);return f},projectPatternOnPointPath:function(n,t,i){var e=[],o=this.getPointPathPixelLength(n)*i,u=this.interpolateOnPointPath(n,t),r,f;if(e.push(u),i>0)for(r=n,r=r.slice(u.predecessor),r[0]=u.pt,f=this.getPointPathPixelLength(r);o<=f;)u=this.interpolateOnPointPath(r,o/f),e.push(u),r=r.slice(u.predecessor),r[0]=u.pt,f=this.getPointPathPixelLength(r);return e},interpolateOnPointPath:function(n,t){var i=n.length,h;if(i<2)return null;if(t<=0)return{pt:n[0],predecessor:0,heading:this.computeAngle(n[0],n[1])};if(t>=1)return{pt:n[i-1],predecessor:i-1,heading:this.computeAngle(n[i-2],n[i-1])};if(i==2)return{pt:this.interpolateBetweenPoints(n[0],n[1],t),predecessor:0,heading:this.computeAngle(n[0],n[1])};for(var c=this.getPointPathPixelLength(n),r=n[0],u=r,o=0,f=0,s=0,e=1;e<i&&f<t;e++)r=u,o=f,u=n[e],s+=r.distanceTo(u),f=s/c;return h=(t-o)/(f-o),{pt:this.interpolateBetweenPoints(r,u,h),predecessor:e-2,heading:this.computeAngle(r,u)}},interpolateBetweenPoints:function(n,t,i){return t.x!=n.x?new L.Point(n.x*(1-i)+i*t.x,n.y*(1-i)+i*t.y):new L.Point(n.x,n.y+(t.y-n.y)*i)}};L.PolylineDecorator=L.LayerGroup.extend({options:{patterns:[]},initialize:function(n,t){L.LayerGroup.prototype.initialize.call(this);L.Util.setOptions(this,t);this._map=null;this._initPaths(n);this._initPatterns()},_initPaths:function(n){var i,t;if(this._paths=[],i=!1,n instanceof L.Polyline)this._initPath(n.getLatLngs(),n instanceof L.Polygon);else if(L.Util.isArray(n)&&n.length>0)if(n[0]instanceof L.Polyline)for(t=0;t<n.length;t++)this._initPath(n[t].getLatLngs(),n[t]instanceof L.Polygon);else this._initPath(n)},_isCoordArray:function(n){return L.Util.isArray(n)&&n.length>0&&(n[0]instanceof L.LatLng||L.Util.isArray(n[0])&&n[0].length==2&&typeof n[0][0]=="number")},_initPath:function(n,t){var u,r,i;for(u=this._isCoordArray(n)?[n]:n,r=this._swapLatLngs(u),i=0;i<r.length;i++)t&&r[i].push(r[i][0]),this._paths.push(r[i])},_swapLatLngs:function(n){for(var i,r=[],t=0;t<n.length;t++)for(r.push([]),i=0;i<n[t].length;i++)r[t].push([n[t][i][1],n[t][i][0]]);return r},_initPatterns:function(){var n,t;for(this._isZoomDependant=!1,this._patterns=[],t=0;t<this.options.patterns.length;t++)n=this._parsePatternDef(this.options.patterns[t]),this._patterns.push(n),this._isZoomDependant=this._isZoomDependant||n.isOffsetInPixels||n.isRepeatInPixels||n.symbolFactory.isZoomDependant},setPatterns:function(n){this.options.patterns=n;this._initPatterns();this._softRedraw()},setPaths:function(n){this._initPaths(n);this.redraw()},_parsePatternDef:function(n){var t={cache:[],symbolFactory:n.symbol,isOffsetInPixels:!1,isRepeatInPixels:!1};return typeof n.offset=="string"&&n.offset.indexOf("%")!=-1?t.offset=parseFloat(n.offset)/100:(t.offset=parseFloat(n.offset),t.isOffsetInPixels=t.offset>0),typeof n.repeat=="string"&&n.repeat.indexOf("%")!=-1?t.repeat=parseFloat(n.repeat)/100:(t.repeat=parseFloat(n.repeat),t.isRepeatInPixels=t.repeat>0),t},onAdd:function(n){if(this._map=n,this._draw(),this._isZoomDependant)this._map.on("zoomend",this._softRedraw,this)},onRemove:function(n){this._map.off("zoomend",this._softRedraw,this);this._map=null;L.LayerGroup.prototype.onRemove.call(this,n)},_buildSymbols:function(n,t,i){for(var u=[],r=0,f=i.length;r<f;r++)u.push(t.buildSymbol(i[r],n,this._map,r,f));return u},_getCache:function(n,t,i){var r=n.cache[t];return typeof r=="undefined"?(n.cache[t]=[],null):r[i]},_getDirectionPoints:function(n,t){var o=this._map.getZoom(),r=this._getCache(t,o,n),f,e,i,u;return r?r:(i=null,u=this._paths[n],t.isOffsetInPixels?(i=L.LineUtil.PolylineDecorator.getPixelLength(u,this._map),f=t.offset/i):f=t.offset,t.isRepeatInPixels?(i=i!==null?i:L.LineUtil.PolylineDecorator.getPixelLength(u,this._map),e=t.repeat/i):e=t.repeat,r=L.LineUtil.PolylineDecorator.projectPatternOnPath(u,f,e,this._map),t.cache[o][n]=r,r)},redraw:function(){this._redraw(!0)},_softRedraw:function(){this._redraw(!1)},_redraw:function(n){if(this._map!==null){if(this.clearLayers(),n)for(var t=0;t<this._patterns.length;t++)this._patterns[t].cache=[];this._draw()}},_drawPattern:function(n){for(var i,u,r,t=0;t<this._paths.length;t++)for(u=this._getDirectionPoints(t,n),r=this._buildSymbols(this._paths[t],n.symbolFactory,u),i=0;i<r.length;i++)this.addLayer(r[i])},_draw:function(){for(var n=0;n<this._patterns.length;n++)this._drawPattern(this._patterns[n])}});L.polylineDecorator=function(n,t){return new L.PolylineDecorator(n,t)};
//# sourceMappingURL=leaflet.polylinedecorator.min.js.map
